// Generated by CoffeeScript 1.7.1
(function() {
  var CrashReporter, binding, spawn;

  spawn = require('child_process').spawn;

  binding = process.atomBinding('crash_reporter');

  CrashReporter = (function() {
    function CrashReporter() {}

    CrashReporter.prototype.start = function(options) {
      var args, autoSubmit, companyName, env, extra, ignoreSystemCrashHandler, productName, start, submitUrl;
      if (options == null) {
        options = {};
      }
      productName = options.productName, companyName = options.companyName, submitUrl = options.submitUrl, autoSubmit = options.autoSubmit, ignoreSystemCrashHandler = options.ignoreSystemCrashHandler, extra = options.extra;
      if (productName == null) {
        productName = 'Atom-Shell';
      }
      if (companyName == null) {
        companyName = 'GitHub, Inc';
      }
      if (submitUrl == null) {
        submitUrl = 'http://54.249.141.255:1127/post';
      }
      if (autoSubmit == null) {
        autoSubmit = true;
      }
      if (ignoreSystemCrashHandler == null) {
        ignoreSystemCrashHandler = false;
      }
      if (extra == null) {
        extra = {};
      }
      if (extra._productName == null) {
        extra._productName = productName;
      }
      if (extra._companyName == null) {
        extra._companyName = companyName;
      }
      if (extra._version == null) {
        extra._version = process.type === 'browser' ? require('app').getVersion() : require('remote').require('app').getVersion();
      }
      start = function() {
        return binding.start(productName, companyName, submitUrl, autoSubmit, ignoreSystemCrashHandler, extra);
      };
      if (process.platform === 'win32') {
        args = ["--reporter-url=" + submitUrl, "--application-name=" + productName, "--v=1"];
        env = {
          ATOM_SHELL_INTERNAL_CRASH_SERVICE: 1
        };
        spawn(process.execPath, args, {
          env: env,
          detached: true
        });
        return start();
      } else {
        return start();
      }
    };

    return CrashReporter;

  })();

  module.exports = new CrashReporter;

}).call(this);
